@using Microsoft.AspNetCore.Identity
@using PharMedTOGO.Areas.Admin.Models
@using PharMedTOGO.Core.Contracts
@using PharMedTOGO.Extensions
@using PharMedTOGO.Infrastrucure.Data.Models
@inject SignInManager<Patient> SignInManager
@inject IAdminService adminService

@{
    int prescriptionId = await adminService.HasUserPrescription(User.Id());
}
<div class="ltn__header-middle-area ltn__logo-right-menu-option ltn__header-row-bg-white ltn__header-padding ltn__header-sticky ltn__sticky-bg-white">
    <div class="container">
        <div class="row">
            <div class="col">
                <div class="site-logo-wrap">
                    <div class="site-logo">
                        <a asp-area="" asp-controller="Home" asp-action="Index">
                            <img src="~/fontawesome-free-6.4.0-web/svgs/solid/pills.svg" alt="Logo">
                        </a>
                        <h3>PharMedTOGO</h3>
                    </div>
                </div>
            </div>


            <div class="col header-menu-column menu-color-white---">
                <div class="header-menu d-none d-xl-block">
                    <nav>
                        <div class="ltn__main-menu">
                            <ul>
                                <li class="menu-icon">
                                    <a asp-area="" asp-controller="Home" asp-action="Index">Home</a>
                                </li>
                                <li class="menu-icon">
                                    <a asp-area="" asp-controller="Medicine" asp-action="All">Store</a>
                                    @if (User.IsAdmin())
                                    {
                                        <ul>
                                            <li><a asp-area="" asp-controller="Medicine" asp-action="Add">Add new medicine</a></li>
                                        </ul>
                                    }
                                </li>
                                @if (User.IsAdmin())
                                {
                                    <li class="menu-icon">
                                        <a asp-area="" asp-controller="Sale" asp-action="All">Sales</a>
                                        <ul>
                                            <li><a asp-area="" asp-controller="Sale" asp-action="Add">Add new sale</a></li>
                                        </ul>
                                    </li>
                                    <li class="menu-icon">
                                        <a asp-area="Admin" asp-controller="Admin" asp-action="Index">administration panel</a>
                                    </li>
                                }
                            </ul>
                        </div>
                    </nav>
                </div>
            </div>
            <div class="col--- ltn__header-options ltn__header-options-2 mb-sm-20">
                <div class="ltn__drop-menu user-menu">
                    <ul>
                        <li>
                            <a href="#"><img src="~/fontawesome-free-6.4.0-web//svgs//solid/circle-user.svg" class="icon-user" /></a>
                            <ul>
                                @if (SignInManager.IsSignedIn(User))
                                {
                                    <li class="nav-item">
                                        <a id="manage" class="nav-link text-dark" asp-area="Identity" asp-page="/Account/Manage/Index" title="Manage">My account</a>
                                    </li>
                                    @* <li class="nav-item">
                                        <a class="nav-link text-dark" asp-controller="Order" asp-action="All">My transactions</a>
                                    </li> *@
                                    @if (prescriptionId != 0)
                                    {
                                        <li class="nav-item">
                                            <a class="nav-link text-dark" asp-area="" asp-controller="Prescription" asp-action="Details" asp-route-id="@prescriptionId">My Prescription</a>
                                        </li>
                                    }
                                    <li class="nav-item">
                                        <form class="form-inline" asp-controller="Patient" asp-action="Logout">
                                            <button type="submit" class="nav-link btn btn-link text-dark">Logout</button>
                                        </form>
                                    </li>
                                }
                                else
                                {
                                    <li class="nav-item">
                                        <a class="nav-link text-dark" asp-controller="Patient" asp-action="Register">Register</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link text-dark" asp-controller="Patient" asp-action="Login">Login</a>
                                    </li>
                                }
                            </ul>
                        </li>
                    </ul>
                </div>

                <div class="mini-cart-icon">
                    <a href="#ltn__utilize-cart-menu" class="ltn__utilize-toggle">
                        <img src="~/fontawesome-free-6.4.0-web//svgs/solid//cart-shopping.svg" class="icon-shopping-cart" />
                    </a>
                </div>


                <div class="mobile-menu-toggle d-xl-none">
                    <a href="#ltn__utilize-mobile-menu" class="ltn__utilize-toggle">
                        <svg viewBox="0 0 800 600">
                            <path d="M300,220 C300,220 520,220 540,220 C740,220 640,540 520,420 C440,340 300,200 300,200" id="top"></path>
                            <path d="M300,320 L540,320" id="middle"></path>
                            <path d="M300,210 C300,210 520,210 540,210 C740,210 640,530 520,410 C440,330 300,190 300,190" id="bottom" transform="translate(480, 320) scale(1, -1) translate(-480, -318) "></path>
                        </svg>
                    </a>
                </div>

            </div>
        </div>
    </div>
</div>
@await Component.InvokeAsync(nameof(MobileMenuComponent))